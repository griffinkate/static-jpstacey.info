<!DOCTYPE html>
<html lang="en" version="XHTML+RDFa 1.0" dir="ltr">
<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../../../../sites/files/jps/starberry_favicon.png" type="image/png" />
<meta name="generator" content="Drupal 7 (https://www.drupal.org)" />
<link rel="canonical" href="openoffice-arrows-soe-files-and-writing-your-own-svg.html" />
<link rel="shortlink" href="../../../../node/61.html" />
  <title>OpenOffice arrows, .soe files and writing your own SVG | J-P Stacey</title>
  <link type="text/css" rel="stylesheet" href="../../../../sites/files/jps/css/css_xE-rWrJf-fncB6ztZfd2huxqgxu4WO-qwma6Xer30m4.css" media="all" />
<link type="text/css" rel="stylesheet" href="../../../../sites/files/jps/css/css_jdej_Zz2sjg--A2C2aVJ-Qt5W-fI_fkFnsddutilsws.css" media="all" />
<link type="text/css" rel="stylesheet" href="../../../../sites/files/jps/css/css_A3Qn9PgslsjDpW1HfgFuI26cQlhJ23E7y9wyYqpiJIA.css" media="all" />
<link type="text/css" rel="stylesheet" href="../../../../sites/files/jps/css/css_0Heb-O6YY5Tn5xG4WrHtAAXZCtYk-eKiVo7PlP1bsg4.css" media="all" />
<link type="text/css" rel="stylesheet" href="../../../../sites/files/jps/css/css_2THG1eGiBIizsWFeexsNe1iDifJ00QRS9uSd03rY9co.css" media="print" />

<!--[if lte IE 7]>
<link type="text/css" rel="stylesheet" href="http://jpstacey.lndo.site/sites/default/themes/custom/barthes/css/ie.css?qfgo2z" media="all" />
<![endif]-->

<!--[if IE 6]>
<link type="text/css" rel="stylesheet" href="http://jpstacey.lndo.site/sites/default/themes/custom/barthes/css/ie6.css?qfgo2z" media="all" />
<![endif]-->
  <script type="text/javascript" src="../../../../sites/files/jps/js/js_vDrW3Ry_4gtSYaLsh77lWhWjIC6ml2QNkcfvfP5CVFs.js"></script>
<script type="text/javascript" src="../../../../sites/files/jps/js/js_gPqjYq7fqdMzw8-29XWQIVoDSWTmZCGy9OqaHppNxuQ.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create", "UA-4775024-1", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("send", "pageview");
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"barthes","theme_token":"LnSDDMKmSQHypxV-CierJAGtOQMP22BBeCVvNhH_9k4","js":{"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/modules\/google_analytics\/googleanalytics.js":1,"0":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/comment\/comment.css":1,"sites\/all\/modules\/date\/date_api\/date.css":1,"sites\/all\/modules\/date\/date_popup\/themes\/datepicker.1.7.css":1,"modules\/field\/theme\/field.css":1,"sites\/all\/modules\/mollom\/mollom.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/views\/css\/views.css":1,"sites\/all\/modules\/media\/modules\/media_wysiwyg\/css\/media_wysiwyg.base.css":1,"sites\/all\/modules\/ctools\/css\/ctools.css":1,"public:\/\/geshi\/geshifilter-languages.css":1,"sites\/all\/modules\/geshifilter\/geshifilter.css":1,"themes\/bartik\/css\/layout.css":1,"themes\/bartik\/css\/style.css":1,"sites\/default\/themes\/custom\/barthes\/css\/colors.css":1,"sites\/default\/themes\/custom\/barthes\/css\/custom.css":1,"themes\/bartik\/css\/print.css":1,"sites\/default\/themes\/custom\/barthes\/css\/ie.css":1,"sites\/default\/themes\/custom\/barthes\/css\/ie6.css":1}},"googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip"}});
//--><!]]>
</script>
</head>
<body class="html not-front not-logged-in one-sidebar sidebar-second page-node page-node- page-node-61 node-type-blog" >
  <div id="skip-link">
    <a href="openoffice-arrows-soe-files-and-writing-your-own-svg.html#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div id="page-wrapper"><div id="page">

  <div id="header" class="with-secondary-menu"><div class="section clearfix">

    
          <div id="name-and-slogan">

                              <div id="site-name">
              <strong>
                <a href="../../../../index.html" title="Home" rel="home"><span>J-P Stacey</span></a>
              </strong>
            </div>
                  
                  <div id="site-slogan">
            Drupal, programming culture, gardening, cycling and the environment          </div>
        
      </div> <!-- /#name-and-slogan -->
    
    
    
          <div id="secondary-menu" class="navigation">
        <h2 class="element-invisible">Secondary menu</h2><ul id="secondary-menu-links" class="links inline clearfix"><li class="menu-7322 first"><a href="../../../../cv.html" title="My curriculum vitae">CV</a></li>
<li class="menu-7320 last"><a href="../../../../contact.html" title="">Contact me</a></li>
</ul>      </div> <!-- /#secondary-menu -->
    
  </div></div> <!-- /.section, /#header -->

  
  
  <div id="main-wrapper" class="clearfix"><div id="main" class="clearfix">

    
    
    <div id="content" class="column"><div class="section">
            <a id="main-content"></a>
                    <h1 class="title" id="page-title">
          OpenOffice arrows, .soe files and writing your own SVG        </h1>
                          <div class="tabs">
                  </div>
                          <div class="region region-content">
    <div id="block-system-main" class="block block-system">

    
  <div class="content">
    <div  class="ds-1col node node-blog node-promoted node-full view-mode-full clearfix">

  
  <div class="field field-name-post-date field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even">Wednesday, August 1, 2007 - 13:48</div></div></div><div class="field field-name-field-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Creating your own arrows in OpenOffice (.org, 2.0) is a pain. There’s tutorials out there that claim to show <a href="http://openoffice.blogs.com/openoffice/2005/11/applying_and_cr.html">how to create arrows from OOo diagrams</a>, but I’ve not had much success with those. However, by taking apart an existing arrow, I’ve managed to work out the rather nasty syntax</p>
<p>OOo arrow libraries are suffixed .soe, and just contain plain-text XML for a full library (so multiple arrows are defined in one file, and only one library can be loaded at once). These libraries sit in your user-specific config directory: to find out where that is, right-click on a line and go to “Line…”, then click on the “Arrow Styles” tab and find the little folder icon for loading new libraries. Click on that, and see where your file explorer puts you.</p>
<p>Arguably it’s easier to either add to or replicate an existing .soe file: the structure is simple enough but there are a lot of namespaces to get right. So open a copy of one of the existing files and have a look inside. It should be structured something like the following:</p>
<blockquote class="code"><p>
&lt;?xml version=”1.0″ ?&gt;<br />
&lt;office:marker-table <i>… xmlns declarations…</i> &gt;<br />
  &lt;draw:marker<br />
    draw:name=”Arrow name”<br />
    svg:viewBox=”<i>x1 y1 x2 y2</i>”<br />
    svg:d=”<i>mess of semi-numerical data</i>” /&gt;<br />
  &lt;draw:marker <i>…</i> /&gt;<br />
  &lt;draw:marker <i>…</i> /&gt;<br />
&lt;/office:marker-table&gt;
</p>
</blockquote>
<p>The mess of data up there is the kicker: it looks a bit like SVG path data, but not quite. The reason is that the spacing is often all over the place, so whilst <a href="http://www.w3.org/TR/SVG11/paths.html#PathDataMovetoCommands">SVG path commands</a> are usually of the form <code>XN</code>, where <code>X</code> is a letter and <code>N</code> a cursor position or a length, OOo frequently seems to prefix commands with numbers. This is actually just an artifact of the format: put spaces in after any number that doesn’t have them, and it reads as a sane SVG path.</p>
<p>So the structure of the arrow can be constructed using the basic, etch-a-sketchy SVG commands, with the following provisos:</p>
<ul><li>Whitespace is irrelevant (see above)</li>
<li>OpenOffice <em>always</em> deals with closed paths. If your path isn’t closed with a terminating <code>z</code> SVG command, OpenOffice will do so for you. It will then <em>fill in</em> this closed path with the line colour! The tutorial above gives you ways of avoiding this, but I think it’s a consequence of SVG not having a native understanding of line width.</li>
<li>OpenOffice has a creative understanding of the standard SVG directions “V” and “H”</li>
<li>The SVG viewbox parameter is probably best left alone: I think it’s similar to the bounding box on postscript files, creating a window for the vector graphic to sit in.</li>
</ul><p>An example is worth a thousand words, even if that example is made up of a thousand hard-to-read SVG commands, so here we go. The image below is a schematic of a three-pronged many-to-one arrow I want to use. The arrow line continues up the page from the junction of the three prongs.</p>
<div class="image image-centre">
<img src="http://www.jpstacey.info/blog/wp-content/uploads/2007/08/oo2_svg_arrow_cropped.gif" alt="OpenOffice many-to-one arrow" /></div>
<p>As you can see, when the parent line is running horizontally (as it appears in the OOo configuration, H actually describes movement along the vertical. With this in mind, the entry for this arrow would read:</p>
<blockquote class="code"><p>
&lt;draw:marker<br />
  draw:name=”Arrow name”<br />
  svg:viewBox=”<i>x1 y1 x2 y2</i>”<br />
  svg:d=”m1000 1162<br />
    l 0 -125 -125 0 -859 859<br />
    v-859<br />
    h-176<br />
    v859<br />
    l -859-859 -125 0 0 125 859 859 213 213<br />
    z” /&gt;
</p>
</blockquote>
<ol><li>[M]ove the cursor to an x/y position to start (this makes the arrow start at the end of the line)</li>
<li>[L]ine: draw towards -v, -h, then along a diagonal</li>
<li>[V]ertical line towards -v, [h]orizontal towards -h, [v]ertical towards +v</li>
<li>[L]ine: draw a diagonal, then towards -h and +v, then two diagonals in the same direction</li>
<li>Clo[z]e the drawing</li>
</ol><p>And that’s it. Fairly simple, as long as you break down your design into SVG primitives first, and realise how OOo is working. There’s some refinements that, as I’ve reverse-engineered much of this, I’ve not been able to go into: the starting position seems to only partly affect the arrow, as it gets centred on the line regardless; the viewbox seems to get ignored. But if anyone can take this any further, than do let me know.</p>
</div></div></div></div>

  </div>
</div>
  </div>
      
    </div></div> <!-- /.section, /#content -->

          <div id="sidebar-second" class="column sidebar"><div class="section">
          <div class="region region-sidebar-second">
    <div id="block-block-7" class="block block-block">

    <h2>I&#039;m a Drupal Association member!</h2>
  
  <div class="content">
    <div style="margin: -15px 0"><a href="https://drupal.org/user/130486"><img src="https://association.drupal.org/files/Drupal_Association_ind_member_217_0.png" alt="My individual membership of the Drupal Association" title="You can view my DA membership on drupal.org" width="168" height="168" /></a></div>
  </div>
</div>
<div id="block-block-10" class="block block-block">

    <h2>Drupal 8 API tutorials</h2>
  
  <div class="content">
    <p>Want to learn about the Drupal 8 APIs, with worked examples? <a href="/d8api.html">Follow my series of tutorials</a>, covering routing, caching, entities, config and much more!</p>
  </div>
</div>
<div id="block-stateblock-stateblock" class="block block-stateblock">

    <h2>Want to hire me?</h2>
  
  <div class="content">
    <a href="../../../../contact.html"><section class="state-no">
  <header>I'm currently</header>
  <section class="state-description">fully booked</section>
  <footer>for freelance work. But you can click here to contact me!</footer>
</section></a>  </div>
</div>
<div id="block-ds-extras-blogpost-secondary-nav" class="block block-ds-extras">

    
  <div class="content">
    <div class="field field-name-taxonomy-vocabulary-6 field-type-taxonomy-term-reference field-label-above clearfix"><h3 class="field-label">Blog category: </h3><ul class="links"><li class="taxonomy-term-reference-0"><a href="../../../../category/wordpress-category/formats.html">formats</a>, <a href="../../../../category/wordpress-category/hacking.html">hacking</a>, <a href="../../../../category/wordpress-category/software.html">software</a>, <a href="../../../../category/wordpress-category/standards.html">standards</a></li></ul></div><div class="field field-name-taxonomy-vocabulary-7 field-type-taxonomy-term-reference field-label-above clearfix"><h3 class="field-label">Tags: </h3><ul class="links"><li class="taxonomy-term-reference-0"><a href="../../../../category/wordpress-tag/uml.html">uml</a>, <a href="../../../../category/wordpress-tag/xml.html">xml</a>, <a href="../../../../category/wordpress-tag/arrow.html">arrow</a>, <a href="../../../../category/wordpress-tag/many-one.html">many-to-one</a>, <a href="../../../../category/wordpress-tag/openoffice.html">openoffice</a>, <a href="../../../../category/wordpress-tag/soe.html">soe</a>, <a href="../../../../category/wordpress-tag/svg.html">svg</a>, <a href="../../../../category/wordpress-tag/svgd.html">svg:d</a>, <a href="../../../../category/wordpress-tag/tutorial.html">tutorial</a>, <a href="../../../../category/wordpress-tag/viewbox.html">viewbox</a></li></ul></div>  </div>
</div>
<div id="block-views-recent-blog-block-1" class="block block-views">

    <h2>Recent blogposts</h2>
  
  <div class="content">
    <div class="view view-recent-blog view-id-recent_blog view-display-id-block_1 view-dom-id-2c6a2371c46e527151e124cdbf9549e7">
        
  
  
      <div class="view-content">
        <ul>
    <li class="first odd">
      
      <h3>
  
    
      <a href="../../../2017-07-21/altering-length-drupal-8-text-field-contains-data.html">Altering the length of a Drupal 8 text field that contains data</a>
      </h3>
  

      <div>
  
    
      Friday, July 21, 2017 - 11:31
      </div>
  
    </li>
      <li class="even">
      
      <h3>
  
    
      <a href="../../../2017-06-02/menagerie-testing-behavioural-unit-system-smoke-regression-oh-my.html">A menagerie of testing: behavioural, unit, system, smoke, regression, oh my!</a>
      </h3>
  

      <div>
  
    
      Friday, June 2, 2017 - 10:11
      </div>
  
    </li>
      <li class="last odd">
      
      <h3>
  
    
      <a href="../../../2017-05-30/including-javascript-behat-tests-all-inside-headless-virtual-machine.html">Including Javascript in Behat tests, all inside a headless, virtual machine</a>
      </h3>
  

      <div>
  
    
      Tuesday, May 30, 2017 - 16:51
      </div>
  
    </li>
    </ul>
    </div>
  
  
  
      
<div class="more-link">
  <a href="../../../../blog_view.html">
    All blogposts  </a>
</div>
  
  
  
</div>  </div>
</div>
<div id="block-block-5" class="block block-block">

    <h2>About me</h2>
  
  <div class="content">
    <p>I'm J-P Stacey, and I'm a freelance technical developer and software architect, working with <a href="http://drupal.org/">Drupal</a>, Javascript, Symfony, PHP and devops, with experience in project and process management and an emphasis on usability.</p>
<p>I live in the <a href="http://gov.uk">UK</a>; my website is self-hosted on <a href="http://bigv.io">bigv.io</a>; my email is hosted by <a href="http://mail.google.com">Google</a>, and that's also what I use to share files. <small>(<a href="https://data-jurisdiction.org/country/GB">More info</a>|<a href="/blog/2013-08-20/what-jurisdiction-am-i-in.html">What is this?</a>)</small></p>
  </div>
</div>
<div id="block-menu-secondary-menu" class="block block-menu">

    <h2>Find me elsewhere</h2>
  
  <div class="content">
    <ul class="menu clearfix"><li class="first leaf"><a href="http://twitter.com/mphield" title="My commercial account on Twitter">Company @ Twitter</a></li>
<li class="leaf"><a href="http://drupal.org/user/130486" title="Drupal user #130486: woohoo!">Drupal @ d.o</a></li>
<li class="leaf"><a href="http://github.com/jpstacey" title="My code repositories on Github">Code @ Github</a></li>
<li class="leaf"><a href="http://flickr.com/photos/eustatius" title="My photos on Flickr">Photos @ Flickr</a></li>
<li class="last leaf"><a href="http://pinboard.in/u:jpstacey" title="My links on the Pinboard bookmarking site">Links @ Pinboard</a></li>
</ul>  </div>
</div>
  </div>
      </div></div> <!-- /.section, /#sidebar-second -->
    
  </div></div> <!-- /#main, /#main-wrapper -->

  
  <div id="footer-wrapper"><div class="section">

    
    
  </div></div> <!-- /.section, /#footer-wrapper -->

</div></div> <!-- /#page, /#page-wrapper -->
  </body>
</html>
