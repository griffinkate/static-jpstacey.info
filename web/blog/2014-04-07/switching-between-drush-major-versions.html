<!DOCTYPE html>
<html lang="en" version="XHTML+RDFa 1.0" dir="ltr">
<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../../sites/files/jps/starberry_favicon.png" type="image/png" />
<meta name="generator" content="Drupal 7 (https://www.drupal.org)" />
<link rel="canonical" href="switching-between-drush-major-versions.html" />
<link rel="shortlink" href="../../node/522.html" />
  <title>Switching between Drush major versions | J-P Stacey</title>
  <link type="text/css" rel="stylesheet" href="../../sites/files/jps/css/css_xE-rWrJf-fncB6ztZfd2huxqgxu4WO-qwma6Xer30m4.css" media="all" />
<link type="text/css" rel="stylesheet" href="../../sites/files/jps/css/css_jdej_Zz2sjg--A2C2aVJ-Qt5W-fI_fkFnsddutilsws.css" media="all" />
<link type="text/css" rel="stylesheet" href="../../sites/files/jps/css/css_A3Qn9PgslsjDpW1HfgFuI26cQlhJ23E7y9wyYqpiJIA.css" media="all" />
<link type="text/css" rel="stylesheet" href="../../sites/files/jps/css/css_0Heb-O6YY5Tn5xG4WrHtAAXZCtYk-eKiVo7PlP1bsg4.css" media="all" />
<link type="text/css" rel="stylesheet" href="../../sites/files/jps/css/css_2THG1eGiBIizsWFeexsNe1iDifJ00QRS9uSd03rY9co.css" media="print" />

<!--[if lte IE 7]>
<link type="text/css" rel="stylesheet" href="http://jpstacey.lndo.site/sites/default/themes/custom/barthes/css/ie.css?qfgo2z" media="all" />
<![endif]-->

<!--[if IE 6]>
<link type="text/css" rel="stylesheet" href="http://jpstacey.lndo.site/sites/default/themes/custom/barthes/css/ie6.css?qfgo2z" media="all" />
<![endif]-->
  <script type="text/javascript" src="../../sites/files/jps/js/js_vDrW3Ry_4gtSYaLsh77lWhWjIC6ml2QNkcfvfP5CVFs.js"></script>
<script type="text/javascript" src="../../sites/files/jps/js/js_gPqjYq7fqdMzw8-29XWQIVoDSWTmZCGy9OqaHppNxuQ.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create", "UA-4775024-1", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("send", "pageview");
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"barthes","theme_token":"C1n20UFLaOFrTTasETynazkga_YOQTi0CVnxEMdOnhk","js":{"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/modules\/google_analytics\/googleanalytics.js":1,"0":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/comment\/comment.css":1,"sites\/all\/modules\/date\/date_api\/date.css":1,"sites\/all\/modules\/date\/date_popup\/themes\/datepicker.1.7.css":1,"modules\/field\/theme\/field.css":1,"sites\/all\/modules\/mollom\/mollom.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/views\/css\/views.css":1,"sites\/all\/modules\/media\/modules\/media_wysiwyg\/css\/media_wysiwyg.base.css":1,"sites\/all\/modules\/ctools\/css\/ctools.css":1,"public:\/\/geshi\/geshifilter-languages.css":1,"sites\/all\/modules\/geshifilter\/geshifilter.css":1,"themes\/bartik\/css\/layout.css":1,"themes\/bartik\/css\/style.css":1,"sites\/default\/themes\/custom\/barthes\/css\/colors.css":1,"sites\/default\/themes\/custom\/barthes\/css\/custom.css":1,"themes\/bartik\/css\/print.css":1,"sites\/default\/themes\/custom\/barthes\/css\/ie.css":1,"sites\/default\/themes\/custom\/barthes\/css\/ie6.css":1}},"googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip"}});
//--><!]]>
</script>
</head>
<body class="html not-front not-logged-in one-sidebar sidebar-second page-node page-node- page-node-522 node-type-blog" >
  <div id="skip-link">
    <a href="switching-between-drush-major-versions.html#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div id="page-wrapper"><div id="page">

  <div id="header" class="with-secondary-menu"><div class="section clearfix">

    
          <div id="name-and-slogan">

                              <div id="site-name">
              <strong>
                <a href="../../index.html" title="Home" rel="home"><span>J-P Stacey</span></a>
              </strong>
            </div>
                  
                  <div id="site-slogan">
            Drupal, programming culture, gardening, cycling and the environment          </div>
        
      </div> <!-- /#name-and-slogan -->
    
    
    
          <div id="secondary-menu" class="navigation">
        <h2 class="element-invisible">Secondary menu</h2><ul id="secondary-menu-links" class="links inline clearfix"><li class="menu-7322 first"><a href="../../cv.html" title="My curriculum vitae">CV</a></li>
<li class="menu-7320 last"><a href="../../contact.html" title="">Contact me</a></li>
</ul>      </div> <!-- /#secondary-menu -->
    
  </div></div> <!-- /.section, /#header -->

  
  
  <div id="main-wrapper" class="clearfix"><div id="main" class="clearfix">

    
    
    <div id="content" class="column"><div class="section">
            <a id="main-content"></a>
                    <h1 class="title" id="page-title">
          Switching between Drush major versions        </h1>
                          <div class="tabs">
                  </div>
                          <div class="region region-content">
    <div id="block-system-main" class="block block-system">

    
  <div class="content">
    <div  class="ds-1col node node-blog node-promoted node-full view-mode-full clearfix">

  
  <div class="field field-name-post-date field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even">Monday, April 7, 2014 - 11:18</div></div></div><div class="field field-name-field-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p><em>[Edit: updated for Drush 8. You might also want to consider <a href="http://whaaat.com/installing-drush-8-using-composer">entirely composer-based Drush version management</a>.]</em></p>
<p>As I do a lot of work on legacy code and sites, I find it useful to have multiple versions of <a href="https://github.com/drush-ops/drush">Drush</a> installed on my laptop; it's also handy for testing version compatibility of my own projects like <a href="https://drupal.org/project/drush_instance">Drush Instance</a>.</p>
<p>However, for convenience I also want to be able to refer to any given Drush version as just "drush" at the command prompt. If you want to do this, you need: local installations of more than one Drush versions, in different locations; and a switching mechanism. Here's one possible solution, for Debian/Ubuntu.</p>
<h3>Installing Drush versions in /opt</h3>
<p>My personal preference for manual installations is in <span class="geshifilter"><code class="text geshifilter-text">/opt</code></span>. I believe this can cause problems on some OSX versions at least, so if you've got some peculiarity with your own system then do feel free to install these packages where you see fit.</p>
<p>To begin, create <span class="geshifilter"><code class="text geshifilter-text">/opt</code></span> if it doesn't already exist, and make it owned by you.</p>
<div class="geshifilter">
<pre class="bash geshifilter-bash" style="font-family:monospace;"><span class="kw2">sudo</span> <span class="kw2">mkdir</span> <span class="sy0">/</span>opt
<span class="kw2">sudo</span> <span class="kw2">chown</span> MY-USERNAME <span class="sy0">/</span>opt</pre></div>
<p>Then install some Drush versions in some subdirectories. Drush 6 to 8 are straightforwardly installable using composer:</p>
<div class="geshifilter">
<pre class="bash geshifilter-bash" style="font-family:monospace;"><span class="kw2">mkdir</span> <span class="sy0">/</span>opt<span class="sy0">/</span>drush6 <span class="sy0">&amp;&amp;</span> <span class="kw3">cd</span> <span class="sy0">/</span>opt<span class="sy0">/</span>drush6
composer require <span class="st0">"drush/drush:6.*"</span>
<span class="kw2">mkdir</span> <span class="sy0">/</span>opt<span class="sy0">/</span>drush7 <span class="sy0">&amp;&amp;</span> <span class="kw3">cd</span> <span class="sy0">/</span>opt<span class="sy0">/</span>drush7
composer require <span class="st0">"drush/drush:7.*"</span>
<span class="kw2">mkdir</span> <span class="sy0">/</span>opt<span class="sy0">/</span>drush8 <span class="sy0">&amp;&amp;</span> <span class="kw3">cd</span> <span class="sy0">/</span>opt<span class="sy0">/</span>drush8
composer require <span class="st0">"drush/drush:dev-master"</span></pre></div>
<p>Drush 5 and earlier don't seem to be installable using composer, but it's very quick to install these manually using the Github zipfile(s):</p>
<div class="geshifilter">
<pre class="bash geshifilter-bash" style="font-family:monospace;"><span class="kw3">cd</span> <span class="sy0">/</span>opt
<span class="kw2">wget</span> https:<span class="sy0">//</span>github.com<span class="sy0">/</span>drush-ops<span class="sy0">/</span>drush<span class="sy0">/</span>archive<span class="sy0">/</span>5.10.0.zip
<span class="kw2">unzip</span> 5.10.0.zip
<span class="kw2">mv</span> drush-5.10.0 drush5</pre></div>
<p>You can now manually reference different versions of Drush thus:</p>
<div class="geshifilter">
<pre class="bash geshifilter-bash" style="font-family:monospace;"><span class="sy0">/</span>opt<span class="sy0">/</span>drush5<span class="sy0">/</span>drush <span class="re5">--version</span>
<span class="sy0">/</span>opt<span class="sy0">/</span>drush6<span class="sy0">/</span>vendor<span class="sy0">/</span>bin<span class="sy0">/</span>drush <span class="re5">--version</span>
<span class="sy0">/</span>opt<span class="sy0">/</span>drush7<span class="sy0">/</span>vendor<span class="sy0">/</span>bin<span class="sy0">/</span>drush <span class="re5">--version</span>
<span class="sy0">/</span>opt<span class="sy0">/</span>drush8<span class="sy0">/</span>vendor<span class="sy0">/</span>bin<span class="sy0">/</span>drush <span class="re5">--version</span></pre></div>
<p>The next step is to make these switchable, so that you can change the version called when you just type "drush".</p>
<h3>Installing into the "alternatives" framework</h3>
<p>On Debian systems, many executables can be managed so that any one of them at any time "serves" the actual command in e.g. <span class="geshifilter"><code class="text geshifilter-text">/usr/bin</code></span>. The command to <a href="http://stackoverflow.com/questions/12787757/how-to-use-the-command-update-alternatives-config-java">manage these alternative versions</a> is called <span class="geshifilter"><code class="text geshifilter-text">update-alternatives</code></span>.</p>
<p>Install your three different Drush versions into the alternatives system using the following commands:</p>
<div class="geshifilter">
<pre class="bash geshifilter-bash" style="font-family:monospace;"><span class="kw2">sudo</span> update-alternatives <span class="re5">--install</span> <span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>drush drush <span class="sy0">/</span>opt<span class="sy0">/</span>drush5<span class="sy0">/</span>drush 5
<span class="kw2">sudo</span> update-alternatives <span class="re5">--install</span> <span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>drush drush <span class="sy0">/</span>opt<span class="sy0">/</span>drush6<span class="sy0">/</span>vendor<span class="sy0">/</span>bin<span class="sy0">/</span>drush 6
<span class="kw2">sudo</span> update-alternatives <span class="re5">--install</span> <span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>drush drush <span class="sy0">/</span>opt<span class="sy0">/</span>drush7<span class="sy0">/</span>vendor<span class="sy0">/</span>bin<span class="sy0">/</span>drush 7
<span class="kw2">sudo</span> update-alternatives <span class="re5">--install</span> <span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>drush drush <span class="sy0">/</span>opt<span class="sy0">/</span>drush8<span class="sy0">/</span>vendor<span class="sy0">/</span>bin<span class="sy0">/</span>drush <span class="nu0">8</span></pre></div>
<p>The last figure is actually a priority: as it's currently set, the system will automatically prioritize Drush 8, because its priority "8" is highest. You could of course set different priorities, so that your preferred major version comes out on top, but we'll see below why it's useful to set the major version number as the priority.</p>
<h3>Switching between Drush versions</h3>
<p>As mentioned above, the highest-priority alternative will be the default, if the alternatives are configured in "auto mode" (again, the default.) However, it's very quick to switch to manual mode, and thus switch to a manually selected alternative.</p>
<p>The recommended way to choose a different alternative at the command line is the following, which calls up an interactive user interface in the terminal:</p>
<div class="geshifilter">
<pre class="bash geshifilter-bash" style="font-family:monospace;"><span class="kw2">sudo</span> update-alternatives <span class="re5">--config</span> drush
There are 3 choices <span class="kw1">for</span> the alternative drush <span class="br0">(</span>providing <span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>drush<span class="br0">)</span>.
...</pre></div>
<p>This interface does require you to then manually press the number of the alternative you want (1..3 in this case) and press enter. Also, the non-interactive alternatives require you to give the full path to the Drush executable, which seems to be a failing of the alternatives system: why register those alternatives in the first place, if you then have to supply their full paths at a later date in order to switch them?</p>
<p>However, there's a shortcut you can use. If you've set your priorities to be your Drush major versions, then the following one-liner will use the filtered output from one <span class="geshifilter"><code class="text geshifilter-text">update-alternatives</code></span> command to automagically set the alternative in a second command:</p>
<div class="geshifilter">
<pre class="bash geshifilter-bash" style="font-family:monospace;"><span class="re2">version</span>=<span class="nu0">6</span>; <span class="kw3">command</span>=<span class="sy0">`</span>update-alternatives <span class="re5">--display</span> drush <span class="sy0">|</span> <span class="kw2">grep</span> <span class="st0">"priority <span class="es2">$version</span>"</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="st_h">'{print $1}'</span><span class="sy0">`</span>; \
  <span class="kw2">sudo</span> update-alternatives <span class="re5">--set</span> drush <span class="st0">"<span class="es2">$command</span>"</span></pre></div>
<p>You could actually save this as a file called <span class="geshifilter"><code class="text geshifilter-text">/usr/bin/switchdrush</code></span>:</p>
<div class="geshifilter">
<pre class="bash geshifilter-bash" style="font-family:monospace;"><span class="co0">#!/bin/bash</span>
 
<span class="re2">version</span>=<span class="st0">"$1"</span>
<span class="kw3">command</span>=<span class="sy0">`</span>update-alternatives <span class="re5">--display</span> drush <span class="sy0">|</span> <span class="kw2">grep</span> <span class="st0">"priority <span class="es2">$version</span>"</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="st_h">'{print $1}'</span><span class="sy0">`</span>
<span class="kw2">sudo</span> update-alternatives <span class="re5">--set</span> drush <span class="st0">"<span class="es2">$command</span>"</span></pre></div>
<p>Then <span class="geshifilter"><code class="text geshifilter-text">sudo chmod +x</code></span> this file, and you can run it in the future as follows:</p>
<div class="geshifilter">
<pre class="bash geshifilter-bash" style="font-family:monospace;">switchdrush <span class="nu0">6</span></pre></div>
<h3>Summary</h3>
<p>You should now be able to switch your Drush version very quickly using the alternatives system.</p>
<p>In principle, much of what the alternatives system provides, you could code yourself. Especially when it comes to having to write the <span class="geshifilter"><code class="text geshifilter-text">switchdrush</code></span> executable. However, in practice, it's reassuring to be able to rely an existing framework that you know is robust: if in doubt, you can always drop back down to that system.</p>
</div></div></div><div id="comments" class="comment-wrapper">
  
  
  </div>
</div>

  </div>
</div>
  </div>
      
    </div></div> <!-- /.section, /#content -->

          <div id="sidebar-second" class="column sidebar"><div class="section">
          <div class="region region-sidebar-second">
    <div id="block-block-7" class="block block-block">

    <h2>I&#039;m a Drupal Association member!</h2>
  
  <div class="content">
    <div style="margin: -15px 0"><a href="https://drupal.org/user/130486"><img src="https://association.drupal.org/files/Drupal_Association_ind_member_217_0.png" alt="My individual membership of the Drupal Association" title="You can view my DA membership on drupal.org" width="168" height="168" /></a></div>
  </div>
</div>
<div id="block-block-10" class="block block-block">

    <h2>Drupal 8 API tutorials</h2>
  
  <div class="content">
    <p>Want to learn about the Drupal 8 APIs, with worked examples? <a href="http://www.jpstacey.info/d8api">Follow my series of tutorials</a>, covering routing, caching, entities, config and much more!</p>
  </div>
</div>
<div id="block-stateblock-stateblock" class="block block-stateblock">

    <h2>Want to hire me?</h2>
  
  <div class="content">
    <a href="../../contact.html"><section class="state-no">
  <header>I'm currently</header>
  <section class="state-description">fully booked</section>
  <footer>for freelance work. But you can click here to contact me!</footer>
</section></a>  </div>
</div>
<div id="block-ds-extras-blogpost-secondary-nav" class="block block-ds-extras">

    
  <div class="content">
    <div class="field field-name-taxonomy-vocabulary-6 field-type-taxonomy-term-reference field-label-above clearfix"><h3 class="field-label">Blog category: </h3><ul class="links"><li class="taxonomy-term-reference-0"><a href="../../category/wordpress-category/software.html">software</a></li></ul></div><div class="field field-name-taxonomy-vocabulary-7 field-type-taxonomy-term-reference field-label-above clearfix"><h3 class="field-label">Tags: </h3><ul class="links"><li class="taxonomy-term-reference-0"><a href="../../category/tags/drush.html">drush</a>, <a href="../../category/wordpress-tag/version.html">version</a>, <a href="../../category/tags/alternative.html">alternative</a>, <a href="../../category/wordpress-tag/configuration.html">configuration</a></li></ul></div>  </div>
</div>
<div id="block-views-recent-blog-block-1" class="block block-views">

    <h2>Recent blogposts</h2>
  
  <div class="content">
    <div class="view view-recent-blog view-id-recent_blog view-display-id-block_1 view-dom-id-24e7fe316cdc542000c3421d2f064d3a">
        
  
  
      <div class="view-content">
        <ul>
    <li class="first odd">
      
      <h3>
  
    
      <a href="../2017-07-21/altering-length-drupal-8-text-field-contains-data.html">Altering the length of a Drupal 8 text field that contains data</a>
      </h3>
  

      <div>
  
    
      Friday, July 21, 2017 - 11:31
      </div>
  
    </li>
      <li class="even">
      
      <h3>
  
    
      <a href="../2017-06-02/menagerie-testing-behavioural-unit-system-smoke-regression-oh-my.html">A menagerie of testing: behavioural, unit, system, smoke, regression, oh my!</a>
      </h3>
  

      <div>
  
    
      Friday, June 2, 2017 - 10:11
      </div>
  
    </li>
      <li class="last odd">
      
      <h3>
  
    
      <a href="../2017-05-30/including-javascript-behat-tests-all-inside-headless-virtual-machine.html">Including Javascript in Behat tests, all inside a headless, virtual machine</a>
      </h3>
  

      <div>
  
    
      Tuesday, May 30, 2017 - 16:51
      </div>
  
    </li>
    </ul>
    </div>
  
  
  
      
<div class="more-link">
  <a href="../../blog_view.html">
    All blogposts  </a>
</div>
  
  
  
</div>  </div>
</div>
<div id="block-block-5" class="block block-block">

    <h2>About me</h2>
  
  <div class="content">
    <p>I'm J-P Stacey, and I'm a freelance technical developer and software architect, working with <a href="http://drupal.org/">Drupal</a>, Javascript, Symfony, PHP and devops, with experience in project and process management and an emphasis on usability.</p>
<p>I live in the <a href="http://gov.uk">UK</a>; my website is self-hosted on <a href="http://bigv.io">bigv.io</a>; my email is hosted by <a href="http://mail.google.com">Google</a>, and that's also what I use to share files. <small>(<a href="https://data-jurisdiction.org/country/GB">More info</a>|<a href="http://www.jpstacey.info/blog/2013-08-20/what-jurisdiction-am-i-in">What is this?</a>)</small></p>
  </div>
</div>
<div id="block-menu-secondary-menu" class="block block-menu">

    <h2>Find me elsewhere</h2>
  
  <div class="content">
    <ul class="menu clearfix"><li class="first leaf"><a href="http://twitter.com/mphield" title="My commercial account on Twitter">Company @ Twitter</a></li>
<li class="leaf"><a href="http://drupal.org/user/130486" title="Drupal user #130486: woohoo!">Drupal @ d.o</a></li>
<li class="leaf"><a href="http://github.com/jpstacey" title="My code repositories on Github">Code @ Github</a></li>
<li class="leaf"><a href="http://flickr.com/photos/eustatius" title="My photos on Flickr">Photos @ Flickr</a></li>
<li class="last leaf"><a href="http://pinboard.in/u:jpstacey" title="My links on the Pinboard bookmarking site">Links @ Pinboard</a></li>
</ul>  </div>
</div>
  </div>
      </div></div> <!-- /.section, /#sidebar-second -->
    
  </div></div> <!-- /#main, /#main-wrapper -->

  
  <div id="footer-wrapper"><div class="section">

    
    
  </div></div> <!-- /.section, /#footer-wrapper -->

</div></div> <!-- /#page, /#page-wrapper -->
  </body>
</html>
