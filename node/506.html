<!DOCTYPE html>
<html lang="en" version="XHTML+RDFa 1.0" dir="ltr">
<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/files/jps/starberry_favicon.png" type="image/png" />
<meta name="generator" content="Drupal 7 (https://www.drupal.org)" />
<link rel="canonical" href="../blog/2013-12-22/exercise-staying-same-only-better-drupal-6-7-upgrade-nhs-forest.html" />
<link rel="shortlink" href="506.html" />
  <title>An exercise in staying the same only better, with the Drupal 6-to-7 upgrade of NHS Forest | J-P Stacey</title>
  <link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_xE-rWrJf-fncB6ztZfd2huxqgxu4WO-qwma6Xer30m4.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_jdej_Zz2sjg--A2C2aVJ-Qt5W-fI_fkFnsddutilsws.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_A3Qn9PgslsjDpW1HfgFuI26cQlhJ23E7y9wyYqpiJIA.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_0Heb-O6YY5Tn5xG4WrHtAAXZCtYk-eKiVo7PlP1bsg4.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_2THG1eGiBIizsWFeexsNe1iDifJ00QRS9uSd03rY9co.css" media="print" />

<!--[if lte IE 7]>
<link type="text/css" rel="stylesheet" href="http://jpstacey.lndo.site/sites/default/themes/custom/barthes/css/ie.css?qfgo2z" media="all" />
<![endif]-->

<!--[if IE 6]>
<link type="text/css" rel="stylesheet" href="http://jpstacey.lndo.site/sites/default/themes/custom/barthes/css/ie6.css?qfgo2z" media="all" />
<![endif]-->
  <script type="text/javascript" src="../sites/files/jps/js/js_vDrW3Ry_4gtSYaLsh77lWhWjIC6ml2QNkcfvfP5CVFs.js"></script>
<script type="text/javascript" src="../sites/files/jps/js/js_gPqjYq7fqdMzw8-29XWQIVoDSWTmZCGy9OqaHppNxuQ.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create", "UA-4775024-1", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("send", "pageview");
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"barthes","theme_token":"BBD27D-XLKw7ejPY2pHB-1FYDEz0hoD_kIk-TDUedqY","js":{"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/modules\/google_analytics\/googleanalytics.js":1,"0":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/comment\/comment.css":1,"sites\/all\/modules\/date\/date_api\/date.css":1,"sites\/all\/modules\/date\/date_popup\/themes\/datepicker.1.7.css":1,"modules\/field\/theme\/field.css":1,"sites\/all\/modules\/mollom\/mollom.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/views\/css\/views.css":1,"sites\/all\/modules\/media\/modules\/media_wysiwyg\/css\/media_wysiwyg.base.css":1,"sites\/all\/modules\/ctools\/css\/ctools.css":1,"public:\/\/geshi\/geshifilter-languages.css":1,"sites\/all\/modules\/geshifilter\/geshifilter.css":1,"themes\/bartik\/css\/layout.css":1,"themes\/bartik\/css\/style.css":1,"sites\/default\/themes\/custom\/barthes\/css\/colors.css":1,"sites\/default\/themes\/custom\/barthes\/css\/custom.css":1,"themes\/bartik\/css\/print.css":1,"sites\/default\/themes\/custom\/barthes\/css\/ie.css":1,"sites\/default\/themes\/custom\/barthes\/css\/ie6.css":1}},"googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip"}});
//--><!]]>
</script>
</head>
<body class="html not-front not-logged-in one-sidebar sidebar-second page-node page-node- page-node-506 node-type-blog" >
  <div id="skip-link">
    <a href="506.html#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div id="page-wrapper"><div id="page">

  <div id="header" class="with-secondary-menu"><div class="section clearfix">

    
          <div id="name-and-slogan">

                              <div id="site-name">
              <strong>
                <a href="../index.html" title="Home" rel="home"><span>J-P Stacey</span></a>
              </strong>
            </div>
                  
                  <div id="site-slogan">
            Drupal, programming culture, gardening, cycling and the environment          </div>
        
      </div> <!-- /#name-and-slogan -->
    
    
    
          <div id="secondary-menu" class="navigation">
        <h2 class="element-invisible">Secondary menu</h2><ul id="secondary-menu-links" class="links inline clearfix"><li class="menu-7322 first"><a href="../cv.html" title="My curriculum vitae">CV</a></li>
<li class="menu-7320 last"><a href="../contact.html" title="">Contact me</a></li>
</ul>      </div> <!-- /#secondary-menu -->
    
  </div></div> <!-- /.section, /#header -->

  
  
  <div id="main-wrapper" class="clearfix"><div id="main" class="clearfix">

    
    
    <div id="content" class="column"><div class="section">
            <a id="main-content"></a>
                    <h1 class="title" id="page-title">
          An exercise in staying the same only better, with the Drupal 6-to-7 upgrade of NHS Forest        </h1>
                          <div class="tabs">
                  </div>
                          <div class="region region-content">
    <div id="block-system-main" class="block block-system">

    
  <div class="content">
    <div  class="ds-1col node node-blog node-promoted node-full view-mode-full clearfix">

  
  <div class="field field-name-post-date field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even">Sunday, December 22, 2013 - 16:26</div></div></div><div class="field field-name-field-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>As Drupal 8, like Christmas, comes ever closer, moving away from Drupal 6 becomes ever more important. While some will be waiting for the <a href="https://groups.drupal.org/imp">proposed D6-&gt;D8 upgrade path</a>, there are others who will benefit from going straight to D7: after all, a lot of us would want to wait until D8 reaches <a href="http://buytaert.net/the-gartner-hype-cycle-and-drupal">the plateau of productivity</a> before making full use of it.</p>
<p>Whole-version upgrades of Drupal sites can be quite problematic, even between two close versions. So I was excited to be able to helped <a href="http://agilecollective.com">Agile Collective</a> with the upgrade of the <a href="http://nhsforest.org">NHS Forest</a> website from Drupal 6 to Drupal 7. Given the time and budget constraints, upgrading had to be a fast, focussed process; it needed to be almost 95% automated, so that it could be run repeatedly, and tweaked each time; and the ultimate remit was one that often strikes fear into developers' hearts: build a new one, but have it work (and look) the same as the old one.</p>
<h2>tl;dr: the end result</h2>
<p>Here's how it looked before:</p>
<p style="text-align:center"><a href="http://www.jpstacey.info/sites/files/jps/nhsforest_screenshot_d6.png"><img alt="" src="http://www.jpstacey.info/sites/files/jps/styles/large/public/nhsforest_screenshot_d6.png" style="height:317px; width:480px" /></a></p>
<p>And here's how it looks after:</p>
<p style="text-align:center"><a href="http://www.jpstacey.info/sites/files/jps/nhsforest_screenshot_d7.png"><img alt="" src="http://www.jpstacey.info/sites/files/jps/styles/large/public/nhsforest_screenshot_d7.png" style="height:324px; width:480px" /></a></p>
<p>Not much difference, right? But that's the point: the new version is now running on Drupal 7, and a good few years of <a href="http://en.wikipedia.org/wiki/Technical_debt">technical debt</a> has been paid back.</p>
<h2>How we did it</h2>
<p>It all turned out to be much easier than you might expect, based on that remit. The automated command-line upgrade tool <a href="https://drupal.org/project/drush_sup">drush sup</a> came to the rescue once again (I've blogged before about <a href="http://www.jpstacey.info/blog/2013-04-21/upgrading-blog-based-drupal-site-6-7">how I used it to upgrade this very website</a>) and did much of the heavy, repetitive lifting. Other Drush commands let us e.g. automatically migrate the content from D6 CCK to D7 Fields. And while very few views survived entirely intact, a custom Drush command was quick to write (using <a href="https://drupal.org/project/drushify">drushify</a>) to inject fixed versions of the views, after migration.</p>
<p>What's most interesting is that porting the theme was probably improved by it being based on a very basic theme in the first place: <a href="https://drupal.org/project/framework">Framework</a>. While the initial forking of Framework for the D6 site clearly involved a lot of work, it ended up a bit like paying technical debt <em>in advance</em>. In D7 we used a child theme, based on Framework, and while a lot of CSS selectors needed changing, the end result was very similar, as you can see: this was the result of perhaps a day or two of initial converting of the CSS, followed by many small tweaks throughout the rest of the project as new functionality came on board. I don't want to decry complex themes like <a href="https://drupal.org/project/omega">Omega</a> (not since <a href="http://www.jpstacey.info/blog/2013-11-27/thanks-nwdug-drupal-camp-north-west">my Damascene conversion at DCNW</a>) but I do wonder how long it would have taken to convert an Omega 3/D6 theme into an Omega 4/D7 one.</p>
<h2>Next steps</h2>
<p>Once we'd deployed the upgraded version of the site, we were able to move onto more interesting new work, and do it rapidly as well. We've now launched a responsive version of the site: on a quick-win basis, we're still going for the low-hanging fruit, in a "mobile last" environment, but here's how far that's come in only a few hours:</p>
<p style="text-align:center"><a href="http://www.jpstacey.info/sites/files/jps/nhsforest_screenshot_d6.png"><img alt="" src="http://www.jpstacey.info/sites/files/jps/styles/large/public/nhsforest_responsive.png" style="height:393px; width:480px" /></a></p>
<p>As a work in progress, there's still scope to make further improvements to the responsiveness as we go on.</p>
<p>In addition, since the D7 go-live, we've added the Twitter Pull/OAuth stack:</p>
<p style="text-align:center"><a href="http://www.jpstacey.info/sites/files/jps/nhsforest_twitter.png"><img alt="" src="http://www.jpstacey.info/sites/files/jps/styles/large/public/nhsforest_twitter.png" style="height:471px; width:480px" /></a></p>
<p>This was very quick to do. In fact, there are a lot of small ongoing requirements with the website, that should now be very quick to do: some of them would have been doable in D6, of course; but you're always wary of committing to <em>any</em> work on an aging platform, when there's so much more possibilities in the newer one.</p>
<h2>Summary</h2>
<p>All in all, I think it's been a real success. The upgrade project came in well under budget, leaving immediate resources for the two improvements mentioned above, and maybe more in the new year! I'm really proud that Agile Collective asked me to be involved in it, and I'm looking forward to more upgrades to D7 and D8 in the future!</p>
</div></div></div></div>

  </div>
</div>
  </div>
      
    </div></div> <!-- /.section, /#content -->

          <div id="sidebar-second" class="column sidebar"><div class="section">
          <div class="region region-sidebar-second">
    <div id="block-block-7" class="block block-block">

    <h2>I&#039;m a Drupal Association member!</h2>
  
  <div class="content">
    <div style="margin: -15px 0"><a href="https://drupal.org/user/130486"><img src="https://association.drupal.org/files/Drupal_Association_ind_member_217_0.png" alt="My individual membership of the Drupal Association" title="You can view my DA membership on drupal.org" width="168" height="168" /></a></div>
  </div>
</div>
<div id="block-block-10" class="block block-block">

    <h2>Drupal 8 API tutorials</h2>
  
  <div class="content">
    <p>Want to learn about the Drupal 8 APIs, with worked examples? <a href="http://www.jpstacey.info/d8api">Follow my series of tutorials</a>, covering routing, caching, entities, config and much more!</p>
  </div>
</div>
<div id="block-stateblock-stateblock" class="block block-stateblock">

    <h2>Want to hire me?</h2>
  
  <div class="content">
    <a href="../contact.html"><section class="state-no">
  <header>I'm currently</header>
  <section class="state-description">fully booked</section>
  <footer>for freelance work. But you can click here to contact me!</footer>
</section></a>  </div>
</div>
<div id="block-ds-extras-blogpost-secondary-nav" class="block block-ds-extras">

    
  <div class="content">
    <div class="field field-name-taxonomy-vocabulary-6 field-type-taxonomy-term-reference field-label-above clearfix"><h3 class="field-label">Blog category: </h3><ul class="links"><li class="taxonomy-term-reference-0"><a href="../category/wordpress-category/projects.html">projects</a></li></ul></div><div class="field field-name-taxonomy-vocabulary-7 field-type-taxonomy-term-reference field-label-above clearfix"><h3 class="field-label">Tags: </h3><ul class="links"><li class="taxonomy-term-reference-0"><a href="../category/wordpress-tag/upgrade.html">upgrade</a>, <a href="../category/tags/drupal6.html">drupal6</a>, <a href="../category/wordpress-tag/drupal7.html">drupal7</a>, <a href="../category/wordpress-tag/charity.html">charity</a>, <a href="../category/wordpress-tag/nonprofit.html">nonprofit</a>, <a href="../category/tags/myportfolio.html">myportfolio</a></li></ul></div>  </div>
</div>
<div id="block-views-recent-blog-block-1" class="block block-views">

    <h2>Recent blogposts</h2>
  
  <div class="content">
    <div class="view view-recent-blog view-id-recent_blog view-display-id-block_1 view-dom-id-0cb92c80fda787c86c082734d3856412">
        
  
  
      <div class="view-content">
        <ul>
    <li class="first odd">
      
      <h3>
  
    
      <a href="../blog/2017-07-21/altering-length-drupal-8-text-field-contains-data.html">Altering the length of a Drupal 8 text field that contains data</a>
      </h3>
  

      <div>
  
    
      Friday, July 21, 2017 - 11:31
      </div>
  
    </li>
      <li class="even">
      
      <h3>
  
    
      <a href="../blog/2017-06-02/menagerie-testing-behavioural-unit-system-smoke-regression-oh-my.html">A menagerie of testing: behavioural, unit, system, smoke, regression, oh my!</a>
      </h3>
  

      <div>
  
    
      Friday, June 2, 2017 - 10:11
      </div>
  
    </li>
      <li class="last odd">
      
      <h3>
  
    
      <a href="../blog/2017-05-30/including-javascript-behat-tests-all-inside-headless-virtual-machine.html">Including Javascript in Behat tests, all inside a headless, virtual machine</a>
      </h3>
  

      <div>
  
    
      Tuesday, May 30, 2017 - 16:51
      </div>
  
    </li>
    </ul>
    </div>
  
  
  
      
<div class="more-link">
  <a href="../blog_view.html">
    All blogposts  </a>
</div>
  
  
  
</div>  </div>
</div>
<div id="block-block-5" class="block block-block">

    <h2>About me</h2>
  
  <div class="content">
    <p>I'm J-P Stacey, and I'm a freelance technical developer and software architect, working with <a href="http://drupal.org/">Drupal</a>, Javascript, Symfony, PHP and devops, with experience in project and process management and an emphasis on usability.</p>
<p>I live in the <a href="http://gov.uk">UK</a>; my website is self-hosted on <a href="http://bigv.io">bigv.io</a>; my email is hosted by <a href="http://mail.google.com">Google</a>, and that's also what I use to share files. <small>(<a href="https://data-jurisdiction.org/country/GB">More info</a>|<a href="http://www.jpstacey.info/blog/2013-08-20/what-jurisdiction-am-i-in">What is this?</a>)</small></p>
  </div>
</div>
<div id="block-menu-secondary-menu" class="block block-menu">

    <h2>Find me elsewhere</h2>
  
  <div class="content">
    <ul class="menu clearfix"><li class="first leaf"><a href="http://twitter.com/mphield" title="My commercial account on Twitter">Company @ Twitter</a></li>
<li class="leaf"><a href="http://drupal.org/user/130486" title="Drupal user #130486: woohoo!">Drupal @ d.o</a></li>
<li class="leaf"><a href="http://github.com/jpstacey" title="My code repositories on Github">Code @ Github</a></li>
<li class="leaf"><a href="http://flickr.com/photos/eustatius" title="My photos on Flickr">Photos @ Flickr</a></li>
<li class="last leaf"><a href="http://pinboard.in/u:jpstacey" title="My links on the Pinboard bookmarking site">Links @ Pinboard</a></li>
</ul>  </div>
</div>
  </div>
      </div></div> <!-- /.section, /#sidebar-second -->
    
  </div></div> <!-- /#main, /#main-wrapper -->

  
  <div id="footer-wrapper"><div class="section">

    
    
  </div></div> <!-- /.section, /#footer-wrapper -->

</div></div> <!-- /#page, /#page-wrapper -->
  </body>
</html>
