<!DOCTYPE html>
<html lang="en" version="XHTML+RDFa 1.0" dir="ltr">
<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/files/jps/starberry_favicon.png" type="image/png" />
<meta name="generator" content="Drupal 7 (https://www.drupal.org)" />
<link rel="canonical" href="../blog/2010/08/25/wednesday-keynote-rasmus-lehrdorf-performance.html" />
<link rel="shortlink" href="346.html" />
  <title>Wednesday keynote: Rasmus Lehrdorf, "Performance" | J-P Stacey</title>
  <link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_xE-rWrJf-fncB6ztZfd2huxqgxu4WO-qwma6Xer30m4.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_jdej_Zz2sjg--A2C2aVJ-Qt5W-fI_fkFnsddutilsws.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_A3Qn9PgslsjDpW1HfgFuI26cQlhJ23E7y9wyYqpiJIA.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_0Heb-O6YY5Tn5xG4WrHtAAXZCtYk-eKiVo7PlP1bsg4.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_2THG1eGiBIizsWFeexsNe1iDifJ00QRS9uSd03rY9co.css" media="print" />

<!--[if lte IE 7]>
<link type="text/css" rel="stylesheet" href="/sites/default/themes/custom/barthes/css/ie.css?qfgo2z" media="all" />
<![endif]-->

<!--[if IE 6]>
<link type="text/css" rel="stylesheet" href="/sites/default/themes/custom/barthes/css/ie6.css?qfgo2z" media="all" />
<![endif]-->
  <script type="text/javascript" src="../sites/files/jps/js/js_vDrW3Ry_4gtSYaLsh77lWhWjIC6ml2QNkcfvfP5CVFs.js"></script>
<script type="text/javascript" src="../sites/files/jps/js/js_gPqjYq7fqdMzw8-29XWQIVoDSWTmZCGy9OqaHppNxuQ.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create", "UA-4775024-1", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("send", "pageview");
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"barthes","theme_token":"-F9Nt0RjX2Mk76ec1t4exmxHXRPV-LE3h-GdwvKVUjY","js":{"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/modules\/google_analytics\/googleanalytics.js":1,"0":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/comment\/comment.css":1,"sites\/all\/modules\/date\/date_api\/date.css":1,"sites\/all\/modules\/date\/date_popup\/themes\/datepicker.1.7.css":1,"modules\/field\/theme\/field.css":1,"sites\/all\/modules\/mollom\/mollom.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/views\/css\/views.css":1,"sites\/all\/modules\/media\/modules\/media_wysiwyg\/css\/media_wysiwyg.base.css":1,"sites\/all\/modules\/ctools\/css\/ctools.css":1,"public:\/\/geshi\/geshifilter-languages.css":1,"sites\/all\/modules\/geshifilter\/geshifilter.css":1,"themes\/bartik\/css\/layout.css":1,"themes\/bartik\/css\/style.css":1,"sites\/default\/themes\/custom\/barthes\/css\/colors.css":1,"sites\/default\/themes\/custom\/barthes\/css\/custom.css":1,"themes\/bartik\/css\/print.css":1,"sites\/default\/themes\/custom\/barthes\/css\/ie.css":1,"sites\/default\/themes\/custom\/barthes\/css\/ie6.css":1}},"googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip"}});
//--><!]]>
</script>
</head>
<body class="html not-front not-logged-in one-sidebar sidebar-second page-node page-node- page-node-346 node-type-blog" >
  <div id="skip-link">
    <a href="346.html#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div id="page-wrapper"><div id="page">

  <div id="header" class="with-secondary-menu"><div class="section clearfix">

    
          <div id="name-and-slogan">

                              <div id="site-name">
              <strong>
                <a href="../index.html" title="Home" rel="home"><span>J-P Stacey</span></a>
              </strong>
            </div>
                  
                  <div id="site-slogan">
            Drupal, programming culture, gardening, cycling and the environment          </div>
        
      </div> <!-- /#name-and-slogan -->
    
    
    
          <div id="secondary-menu" class="navigation">
        <h2 class="element-invisible">Secondary menu</h2><ul id="secondary-menu-links" class="links inline clearfix"><li class="menu-7322 first"><a href="../cv.html" title="My curriculum vitae">CV</a></li>
<li class="menu-7320 last"><a href="../contact.html" title="">Contact me</a></li>
</ul>      </div> <!-- /#secondary-menu -->
    
  </div></div> <!-- /.section, /#header -->

  
  
  <div id="main-wrapper" class="clearfix"><div id="main" class="clearfix">

    
    
    <div id="content" class="column"><div class="section">
            <a id="main-content"></a>
                    <h1 class="title" id="page-title">
          Wednesday keynote: Rasmus Lehrdorf, &quot;Performance&quot;        </h1>
                          <div class="tabs">
                  </div>
                          <div class="region region-content">
    <div id="block-system-main" class="block block-system">

    
  <div class="content">
    <div  class="ds-1col node node-blog node-promoted node-full view-mode-full clearfix">

  
  <div class="field field-name-post-date field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even">Wednesday, August 25, 2010 - 14:13</div></div></div><div class="field field-name-field-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Start in 1993. Mosaic.</p>
<p>Was working for a company building on greenscreen thin terminal dinosaurs, trying to extend tech.<br />
Trying to build apps on these.<br />
We have to move to the web.<br />
Slow to move<br />
So I quit.</p>
<p>Websites in 1993 had a CGI counter on each page that forked a Perl exec. Extremely slow.</p>
<p>What we wanted was HTML with inline exec on every page.</p>
<p>1994 PHP born. Embedded in HTML comment tags.<br />
SQL from the start. MiniSQL.</p>
<p>HTML comments tiring, so read a book on parsers... Rewrote in 1995 to look more like a real language, but with no braces.</p>
<p>2001 Drupal<br />
Same db example is much more verbose... Kind of prefer 1995 version...!</p>
<p>Perl, awk... That set of people<br />
10 years later expectation was object orientation<br />
Not about religion, but about familiar interfaces [pragmatic]<br />
On third try, did a good job in PHP5</p>
<p>5.3.3<br />
Closures<br />
Namespaces with a backslash...! Every other character would have caused parser conflicts.<br />
Constructors in PHP4 - eponymous function<br />
Bugfix in 5.3.3 for namespace class versus namespaced constructor.<br />
Late Static Binding to work out what class the method is called on in the hierarchy<br />
NOWDOC<br />
Ternary shortcut<br />
goto - we had multilevel breaks for ages. This is just a new keyword. If we'd called it a label break nobody would've cared, which shows a lot of people are pretty stupid.<br />
DateInterval / DatePeriod</p>
<p>Performance matters because even e.g. Google PageRank affected by response.</p>
<p>One core VM running 5 concurrent clients. PHP Fast Process Management<br />
Fairly underpowered box.</p>
<p>ENABLE APC or some other opcode cache<br />
Set default timezone!</p>
<p>160ms latency 4x increase in performance by installing an opcode cache.</p>
<p>Check not CPU-bound or sitting in io wait state - vmstat 1</p>
<p>Webserver pretty much irrelevant<br />
Single-core gives multiplexing problems so slower on lots of concurrent requests.<br />
Max concurrent requests shouldn't be much more than 5 per core<br />
At yahoo was around 3 per core</p>
<p>Require-once rant. Please listen. Nobody listened in Szeged.</p>
<p>Doing a strace. Lots and lots of opens.<br />
Everything is doing a require-once<br />
So many of them not necessary.<br />
Costs an extra system call and an extra hash lookup<br />
Performance wise not a huge deal unless rung over nfs in which case it's a huge deal<br />
Too paranoid?</p>
<p>DB autoloader doesn't need to ever not be loaded.</p>
<p>Checking for settings, poking around, on every single request. Can we not just hardcode that? Even by default it looks in the wrong place.<br />
A bunch of explodes and implodes</p>
<p>There's a balance between flexibility and performance, always.</p>
<p>"It's for multisite'</p>
<p>I know it's for multisite, but I didn't install multisite. I went through the default installer. It should be able to work this out.</p>
<p>Extra 10ms shaved off - maybe 60ms if NFS.</p>
<p>Original intention in PHP was to do templating in PHP and heavy lifting in C. Most of the world doesn't do that because C is hard. But C is FAST.</p>
<p>Some of the heavy lifting should be moved to an extension.</p>
<p>Someone did it, but only got around 1 percent. But this only implemented two functions. On the list of the two main functions, these were tenth and nowhere.</p>
<p>They get called the most, but they aren't that expensive to begin with.</p>
<p>Xdebug and kcachegrind<br />
Pretty clear it's drupal-render</p>
<p>RINIT and RSHUTDOWN in an extension get called on every single request, whether function actually used.<br />
The drupal-static extension clears functions out of cache table. Can't see why. But we added an extra 0.34 percent by doing this stuff. Hence only a percent saving.</p>
<p>Hiphop<br />
D7 pdo won't work with Hiphop as it currently is.<br />
Few tips. Get APC cache info, because compilation is slow under Hiphop<br />
Get a compiled native executable with a web server baked in...!<br />
Facebook are fixing PDO thing<br />
"they are. Scott said so last week"<br />
He did? Was he drunk?<br />
But this probably isn't going to give you so much</p>
<p>Need to look more at the architecture<br />
Are we using MySQL? Ten milliseconds later... are we using MySQL?<br />
C-based rendering engine for Drupal</p>
<p>"OO attract more developers? Young developers?"</p>
<p>... Don't think it's such a big deal. Features, performance, documentation. PHP is not beautiful. It's about solving people's problems.</p>
<p>"problems with php dev process?"</p>
<p>It's slow. People build what they need. If people aren't personally interested, just doesn't get done. When it doesn't happen, or it's a mismatch, there's frustration. Stop complaining and pitch in.</p>
<p>[isn't this how software projects drift away from being used by non-developers?]</p>
<p>"why shouldn't Drupal move to another language?"</p>
<p>How does the end user benefit? They don't care about the language. They wont to click on the link and they want it to work. That's what they care about.</p>
<p>[suddenly we're back on user focus, not developer focus?]</p>
<p>Gonna take years, with no discernible improvement. Spend time improving the product.</p>
<p>We might get more language agnostic. C based rendering engine. We could then write a drupal module in say Ruby or Python.</p>
<p>"what keeps you excited about PHP?"</p>
<p>I've never been that excited about php. So it's pretty easy to keep that up. I use it to solve problems. If it works, I don't care. I'm not going to be more visible in the community.</p>
<p>I didn't sign up for this twenty-year job. If you want to take over, go ahead.</p>
<p>I think it's still the best tool for the job.</p>
<p>"lambda functions?"</p>
<p>No big deal. Just solves syntax problems. Everyone here spends half their time in Javascript. So you get used to closures.</p>
<p>"do you have a vision for 2020?"</p>
<p>Really hope I'm not standing in front of you guys in ten years.</p>
<p>What I said earlier. Move higher. C. Core of Drupal. Infrastructure you can build around. Flexible. Agnostic</p>
<p>"Did you  look at the effect of lots of modules on the site?"</p>
<p>I didn't want to make myself depressed. A lot of modules do stupid things and there's a whole talk in itself in that. The main problems are still in core and we can see them in Xdebug <em>[it sounds like modules have to be assessed on a per-module basis; extra modules themselves are a minor performance hit compared to drupal_render]</em></p>
</div></div></div></div>

  </div>
</div>
  </div>
      
    </div></div> <!-- /.section, /#content -->

          <div id="sidebar-second" class="column sidebar"><div class="section">
          <div class="region region-sidebar-second">
    <div id="block-block-7" class="block block-block">

    <h2>I&#039;m a Drupal Association member!</h2>
  
  <div class="content">
    <div style="margin: -15px 0"><a href="https://drupal.org/user/130486"><img src="https://association.drupal.org/files/Drupal_Association_ind_member_217_0.png" alt="My individual membership of the Drupal Association" title="You can view my DA membership on drupal.org" width="168" height="168" /></a></div>
  </div>
</div>
<div id="block-block-10" class="block block-block">

    <h2>Drupal 8 API tutorials</h2>
  
  <div class="content">
    <p>Want to learn about the Drupal 8 APIs, with worked examples? <a href="/d8api.html">Follow my series of tutorials</a>, covering routing, caching, entities, config and much more!</p>
  </div>
</div>
<div id="block-stateblock-stateblock" class="block block-stateblock">

    <h2>Want to hire me?</h2>
  
  <div class="content">
    <a href="../contact.html"><section class="state-no">
  <header>I'm currently</header>
  <section class="state-description">fully booked</section>
  <footer>for freelance work. But you can click here to contact me!</footer>
</section></a>  </div>
</div>
<div id="block-ds-extras-blogpost-secondary-nav" class="block block-ds-extras">

    
  <div class="content">
    <div class="field field-name-taxonomy-vocabulary-6 field-type-taxonomy-term-reference field-label-above clearfix"><h3 class="field-label">Blog category: </h3><ul class="links"><li class="taxonomy-term-reference-0"><a href="../category/wordpress-category/conferences.html">conferences</a></li></ul></div><div class="field field-name-taxonomy-vocabulary-7 field-type-taxonomy-term-reference field-label-above clearfix"><h3 class="field-label">Tags: </h3><ul class="links"><li class="taxonomy-term-reference-0"><a href="../category/tags/dccph.html">dccph</a></li></ul></div>  </div>
</div>
<div id="block-views-recent-blog-block-1" class="block block-views">

    <h2>Recent blogposts</h2>
  
  <div class="content">
    <div class="view view-recent-blog view-id-recent_blog view-display-id-block_1 view-dom-id-d5436bdd631f26749ecfdb53f4620084">
        
  
  
      <div class="view-content">
        <ul>
    <li class="first odd">
      
      <h3>
  
    
      <a href="../blog/2017-07-21/altering-length-drupal-8-text-field-contains-data.html">Altering the length of a Drupal 8 text field that contains data</a>
      </h3>
  

      <div>
  
    
      Friday, July 21, 2017 - 11:31
      </div>
  
    </li>
      <li class="even">
      
      <h3>
  
    
      <a href="../blog/2017-06-02/menagerie-testing-behavioural-unit-system-smoke-regression-oh-my.html">A menagerie of testing: behavioural, unit, system, smoke, regression, oh my!</a>
      </h3>
  

      <div>
  
    
      Friday, June 2, 2017 - 10:11
      </div>
  
    </li>
      <li class="last odd">
      
      <h3>
  
    
      <a href="../blog/2017-05-30/including-javascript-behat-tests-all-inside-headless-virtual-machine.html">Including Javascript in Behat tests, all inside a headless, virtual machine</a>
      </h3>
  

      <div>
  
    
      Tuesday, May 30, 2017 - 16:51
      </div>
  
    </li>
    </ul>
    </div>
  
  
  
      
<div class="more-link">
  <a href="../blog_view.html">
    All blogposts  </a>
</div>
  
  
  
</div>  </div>
</div>
<div id="block-block-5" class="block block-block">

    <h2>About me</h2>
  
  <div class="content">
    <p>I'm J-P Stacey, and I'm a freelance technical developer and software architect, working with <a href="http://drupal.org/">Drupal</a>, Javascript, Symfony, PHP and devops, with experience in project and process management and an emphasis on usability.</p>
<p>I live in the <a href="http://gov.uk">UK</a>; my website is self-hosted on <a href="http://bigv.io">bigv.io</a>; my email is hosted by <a href="http://mail.google.com">Google</a>, and that's also what I use to share files. <small>(<a href="https://data-jurisdiction.org/country/GB">More info</a>|<a href="/blog/2013-08-20/what-jurisdiction-am-i-in.html">What is this?</a>)</small></p>
  </div>
</div>
<div id="block-menu-secondary-menu" class="block block-menu">

    <h2>Find me elsewhere</h2>
  
  <div class="content">
    <ul class="menu clearfix"><li class="first leaf"><a href="http://twitter.com/mphield" title="My commercial account on Twitter">Company @ Twitter</a></li>
<li class="leaf"><a href="http://drupal.org/user/130486" title="Drupal user #130486: woohoo!">Drupal @ d.o</a></li>
<li class="leaf"><a href="http://github.com/jpstacey" title="My code repositories on Github">Code @ Github</a></li>
<li class="leaf"><a href="http://flickr.com/photos/eustatius" title="My photos on Flickr">Photos @ Flickr</a></li>
<li class="last leaf"><a href="http://pinboard.in/u:jpstacey" title="My links on the Pinboard bookmarking site">Links @ Pinboard</a></li>
</ul>  </div>
</div>
  </div>
      </div></div> <!-- /.section, /#sidebar-second -->
    
  </div></div> <!-- /#main, /#main-wrapper -->

  
  <div id="footer-wrapper"><div class="section">

    
    
  </div></div> <!-- /.section, /#footer-wrapper -->

</div></div> <!-- /#page, /#page-wrapper -->
  </body>
</html>
