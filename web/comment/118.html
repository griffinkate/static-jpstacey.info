<!DOCTYPE html>
<html lang="en" version="XHTML+RDFa 1.0" dir="ltr">
<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/files/jps/starberry_favicon.png" type="image/png" />
<meta name="generator" content="Drupal 7 (https://www.drupal.org)" />
<link rel="canonical" href="../blog/2010/09/15/exporting-your-tables-features-dozen-lines.html" />
<link rel="shortlink" href="../node/354.html" />
  <title>Exporting your tables via features in a dozen lines | J-P Stacey</title>
  <link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_xE-rWrJf-fncB6ztZfd2huxqgxu4WO-qwma6Xer30m4.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_jdej_Zz2sjg--A2C2aVJ-Qt5W-fI_fkFnsddutilsws.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_A3Qn9PgslsjDpW1HfgFuI26cQlhJ23E7y9wyYqpiJIA.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_0Heb-O6YY5Tn5xG4WrHtAAXZCtYk-eKiVo7PlP1bsg4.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/files/jps/css/css_2THG1eGiBIizsWFeexsNe1iDifJ00QRS9uSd03rY9co.css" media="print" />

<!--[if lte IE 7]>
<link type="text/css" rel="stylesheet" href="http://jpstacey.lndo.site/sites/default/themes/custom/barthes/css/ie.css?qfgo2z" media="all" />
<![endif]-->

<!--[if IE 6]>
<link type="text/css" rel="stylesheet" href="http://jpstacey.lndo.site/sites/default/themes/custom/barthes/css/ie6.css?qfgo2z" media="all" />
<![endif]-->
  <script type="text/javascript" src="../sites/files/jps/js/js_vDrW3Ry_4gtSYaLsh77lWhWjIC6ml2QNkcfvfP5CVFs.js"></script>
<script type="text/javascript" src="../sites/files/jps/js/js_gPqjYq7fqdMzw8-29XWQIVoDSWTmZCGy9OqaHppNxuQ.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create", "UA-4775024-1", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("send", "pageview");
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"barthes","theme_token":"XgXcijefaD080opsm_FSbjHhKt0RTNRI2-N3I_rRQDo","js":{"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/modules\/google_analytics\/googleanalytics.js":1,"0":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/comment\/comment.css":1,"sites\/all\/modules\/date\/date_api\/date.css":1,"sites\/all\/modules\/date\/date_popup\/themes\/datepicker.1.7.css":1,"modules\/field\/theme\/field.css":1,"sites\/all\/modules\/mollom\/mollom.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/views\/css\/views.css":1,"sites\/all\/modules\/media\/modules\/media_wysiwyg\/css\/media_wysiwyg.base.css":1,"sites\/all\/modules\/ctools\/css\/ctools.css":1,"public:\/\/geshi\/geshifilter-languages.css":1,"sites\/all\/modules\/geshifilter\/geshifilter.css":1,"themes\/bartik\/css\/layout.css":1,"themes\/bartik\/css\/style.css":1,"sites\/default\/themes\/custom\/barthes\/css\/colors.css":1,"sites\/default\/themes\/custom\/barthes\/css\/custom.css":1,"themes\/bartik\/css\/print.css":1,"sites\/default\/themes\/custom\/barthes\/css\/ie.css":1,"sites\/default\/themes\/custom\/barthes\/css\/ie6.css":1}},"googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip"}});
//--><!]]>
</script>
</head>
<body class="html not-front not-logged-in one-sidebar sidebar-second page-node page-node- page-node-354 node-type-blog" >
  <div id="skip-link">
    <a href="118.html#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div id="page-wrapper"><div id="page">

  <div id="header" class="with-secondary-menu"><div class="section clearfix">

    
          <div id="name-and-slogan">

                              <div id="site-name">
              <strong>
                <a href="../index.html" title="Home" rel="home"><span>J-P Stacey</span></a>
              </strong>
            </div>
                  
                  <div id="site-slogan">
            Drupal, programming culture, gardening, cycling and the environment          </div>
        
      </div> <!-- /#name-and-slogan -->
    
    
    
          <div id="secondary-menu" class="navigation">
        <h2 class="element-invisible">Secondary menu</h2><ul id="secondary-menu-links" class="links inline clearfix"><li class="menu-7322 first"><a href="../cv.html" title="My curriculum vitae">CV</a></li>
<li class="menu-7320 last"><a href="../contact.html" title="">Contact me</a></li>
</ul>      </div> <!-- /#secondary-menu -->
    
  </div></div> <!-- /.section, /#header -->

  
  
  <div id="main-wrapper" class="clearfix"><div id="main" class="clearfix">

    
    
    <div id="content" class="column"><div class="section">
            <a id="main-content"></a>
                    <h1 class="title" id="page-title">
          Exporting your tables via features in a dozen lines        </h1>
                          <div class="tabs">
                  </div>
                          <div class="region region-content">
    <div id="block-system-main" class="block block-system">

    
  <div class="content">
    <div  class="ds-1col node node-blog node-promoted node-full view-mode-full clearfix">

  
  <div class="field field-name-post-date field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even">Wednesday, September 15, 2010 - 21:29</div></div></div><div class="field field-name-field-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Stella's written an excellent blogpost on <a href="http://stellapower.net/content/using-chaos-tools-module-create-exportables">Using CTools in Drupal to make exportables</a>, which feeds in so nicely to integrating your generic database table with <a href="http://drupal.org/project/features">Drupal Features</a> that <a href="http://drupalcode.org/viewvc/drupal/contributions/modules/features/API.txt?revision=1.1.2.5&amp;view=co&amp;pathrev=DRUPAL-6--1">the module maintainers recommend it</a> as an intro to hooking your module up through CTools and making database data exportable using it (there's also <a href="http://drupalcode.org/viewvc/drupal/contributions/modules/ctools/help/export.html?view=markup&amp;pathrev=HEAD">documentation in CTools itself</a> but it's best used as a reference.)</p>
<p>Because Stella's post covers admin interfaces and helper functions, and has been made generic so people can adapt it, then it covers far more than just integration. So when I worked out <em>just how tiny</em> the absolute bare minimum you needed to integrate a database table with Features really was, I thought it was worth writing a blogpost which boils Features/CTools exportables down to their impressive distillates.</p>
<p>Here's my example. Imagine you're building a <span class="geshifilter"><code class="text geshifilter-text">contacts</code></span> module which just creates a database table through <span class="geshifilter"><code class="text geshifilter-text">hook_schema</code></span>. This table will be used to store your friends' contact details: at first, a unique nickname and their full name. The module does nothing more, so here's its contacts.info file:</p>
<div class="geshifilter">
<pre class="ini geshifilter-ini" style="font-family:monospace;"><span class="re1">name</span> <span class="sy0">=</span><span class="re2"> Contacts</span>
<span class="re1">description</span> <span class="sy0">=</span><span class="re2"> All my contacts</span>
<span class="re1">core</span> <span class="sy0">=</span><span class="re2"> 6.x</span></pre></div>
<p>And here's the contacts.module file:</p>
<div class="geshifilter">
<pre class="php geshifilter-php" style="font-family:monospace;"><span class="co1">// Empty file!</span></pre></div>
<p>Tiny, isn't it? That's because all our clutter is in the database schema for now. So we use <span class="geshifilter"><code class="text geshifilter-text">hook_schema</code></span> to define the database schema, and <span class="geshifilter"><code class="text geshifilter-text">hook_install</code></span>/<span class="geshifilter"><code class="text geshifilter-text">hook_uninstall</code></span> to create and drop the table for our friends' information:</p>
<div class="geshifilter">
<pre class="php geshifilter-php" style="font-family:monospace;"><span class="co4">/**
 * Implementation of hook_install
 */</span>
<span class="kw2">function</span> contacts_install<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
  drupal_install_schema<span class="br0">(</span><span class="st_h">'contacts'</span><span class="br0">)</span><span class="sy0">;</span>
<span class="br0">}</span>
 
<span class="co4">/**
 * Implementation of hook_install
 */</span>
<span class="kw2">function</span> contacts_uninstall<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
  drupal_install_schema<span class="br0">(</span><span class="st_h">'contacts'</span><span class="br0">)</span><span class="sy0">;</span>
<span class="br0">}</span>
 
<span class="co4">/**
 * Implementation of hook_schema
 */</span>
<span class="kw2">function</span> contacts_schema<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
  <span class="re0">$schema</span><span class="br0">[</span><span class="st_h">'contacts_friend'</span><span class="br0">]</span> <span class="sy0">=</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
    <span class="st_h">'description'</span> <span class="sy0">=&gt;</span> t<span class="br0">(</span><span class="st_h">'Friends'</span><span class="br0">)</span><span class="sy0">,</span>
    <span class="st_h">'fields'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
      <span class="st_h">'nickname'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
        <span class="st_h">'description'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Unique nickname for friend'</span><span class="sy0">,</span>
        <span class="st_h">'type'</span> <span class="sy0">=&gt;</span> <span class="st_h">'varchar'</span><span class="sy0">,</span>
        <span class="st_h">'length'</span> <span class="sy0">=&gt;</span> <span class="nu0">32</span><span class="sy0">,</span>
        <span class="st_h">'not null'</span> <span class="sy0">=&gt;</span> <span class="kw4">TRUE</span><span class="sy0">,</span>
      <span class="br0">)</span><span class="sy0">,</span>
      <span class="st_h">'fullname'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
        <span class="st_h">'description'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Friend fullname'</span><span class="sy0">,</span>
        <span class="st_h">'type'</span> <span class="sy0">=&gt;</span> <span class="st_h">'varchar'</span><span class="sy0">,</span>
        <span class="st_h">'length'</span> <span class="sy0">=&gt;</span> <span class="nu0">128</span><span class="sy0">,</span>
        <span class="st_h">'not null'</span> <span class="sy0">=&gt;</span> <span class="kw4">TRUE</span><span class="sy0">,</span>
      <span class="br0">)</span><span class="sy0">,</span>
 
    <span class="st_h">'primary key'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span><span class="st_h">'nickname'</span><span class="br0">)</span><span class="sy0">,</span>
  <span class="br0">)</span><span class="sy0">;</span>
  <span class="kw1">return</span> <span class="re0">$schema</span><span class="sy0">;</span>
<span class="br0">}</span></pre></div>
<p>This is all standard schema API stuff: if you're not sure what any of this means, check out the <a href="http://drupal.org/node/146843">Schema API documentation</a> for more information. Incidentally, good database maintainers might blanch at the idea of a text primary key. I feel your pain, but for this demo---and for a friendly Features admin interface---it's necessary, as we'll see below.</p>
<p>So now you've got your module. You haven't worried about features yet, but you suddenly realized you might want to export friends through Features, so you can import them into some other site. How do you do that? Well, you add nine lines of array code to your database schema: a new <span class="geshifilter"><code class="text geshifilter-text">'export'</code></span> array key in the table schema with the following contents:</p>
<div class="geshifilter">
<pre class="php geshifilter-php" style="font-family:monospace;"><span class="co4">/**
 * Implementation of hook_schema
 */</span>
<span class="kw2">function</span> contacts_schema<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
  <span class="re0">$schema</span><span class="br0">[</span><span class="st_h">'contacts_friend'</span><span class="br0">]</span> <span class="sy0">=</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
    <span class="st_h">'description'</span> <span class="sy0">=&gt;</span> t<span class="br0">(</span><span class="st_h">'Friends'</span><span class="br0">)</span><span class="sy0">,</span>
 
    <span class="co1">// This is all the CTools Exportables block</span>
    <span class="st_h">'export'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
      <span class="co1">// Unique key to identify an object</span>
      <span class="st_h">'key'</span> <span class="sy0">=&gt;</span> <span class="st_h">'nickname'</span><span class="sy0">,</span>
      <span class="co1">// Object type identifier, e.g. "enemy" for your enemy exportables!</span>
      <span class="st_h">'identifier'</span> <span class="sy0">=&gt;</span> <span class="st_h">'friend'</span><span class="sy0">,</span>
      <span class="co1">// Function hook name in Features dump</span>
      <span class="st_h">'default hook'</span> <span class="sy0">=&gt;</span> <span class="st_h">'default_contacts_myobj'</span><span class="sy0">,</span>
      <span class="st_h">'api'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
        <span class="co1">// Which module "owns" these objects?</span>
        <span class="st_h">'owner'</span> <span class="sy0">=&gt;</span> <span class="st_h">'contacts'</span><span class="sy0">,</span>
        <span class="co1">// Base name for Features include file</span>
        <span class="st_h">'api'</span> <span class="sy0">=&gt;</span> <span class="st_h">'default_contacts_friends'</span><span class="sy0">,</span>
        <span class="co1">// Exportables API version numbers: black magic; woowoo</span>
        <span class="st_h">'minimum_version'</span> <span class="sy0">=&gt;</span> <span class="nu0">1</span><span class="sy0">,</span>
        <span class="st_h">'current_version'</span> <span class="sy0">=&gt;</span> <span class="nu0">1</span><span class="sy0">,</span>
      <span class="br0">)</span><span class="sy0">,</span>
    <span class="br0">)</span><span class="sy0">,</span>
 
    <span class="st_h">'fields'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
      <span class="st_h">'nickname'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
        <span class="st_h">'description'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Unique nickname for friend'</span><span class="sy0">,</span>
        <span class="st_h">'type'</span> <span class="sy0">=&gt;</span> <span class="st_h">'varchar'</span><span class="sy0">,</span>
        <span class="st_h">'length'</span> <span class="sy0">=&gt;</span> <span class="nu0">32</span><span class="sy0">,</span>
        <span class="st_h">'not null'</span> <span class="sy0">=&gt;</span> <span class="kw4">TRUE</span><span class="sy0">,</span>
      <span class="br0">)</span><span class="sy0">,</span>
      <span class="st_h">'fullname'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
        <span class="st_h">'description'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Friend fullname'</span><span class="sy0">,</span>
        <span class="st_h">'type'</span> <span class="sy0">=&gt;</span> <span class="st_h">'varchar'</span><span class="sy0">,</span>
        <span class="st_h">'length'</span> <span class="sy0">=&gt;</span> <span class="nu0">128</span><span class="sy0">,</span>
        <span class="st_h">'not null'</span> <span class="sy0">=&gt;</span> <span class="kw4">TRUE</span><span class="sy0">,</span>
      <span class="br0">)</span><span class="sy0">,</span>
 
    <span class="st_h">'primary key'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span><span class="st_h">'nickname'</span><span class="br0">)</span><span class="sy0">,</span>
  <span class="br0">)</span><span class="sy0">;</span>
  <span class="kw1">return</span> <span class="re0">$schema</span><span class="sy0">;</span>
<span class="br0">}</span></pre></div>
<p>And that's it, in the first instance. When you add some friends to that table---you'll have to do it with SQL or phpMySQL for the moment, unless you build an admin interface---they should automatically appear as exportables in the Features creation interface. The human-readable label will be their 'export' 'key', which is why we needed that key to be human-readable. You could have a unique serial ID as well, and impose a mere unique_key constraint on the nickname field, but Features don't work terribly well with serial IDs for now; you'd need to make sure CTools does not export that column.</p>
<p>Which leads me neatly onto the next example. Let's say you add a column that tells you whether you secretly hate each "friend" or not, and you don't want that getting exported out in case people find out what you think about them. This column is just an integer/boolean, so you add your field description array as usual... with one extra array key called, with similar boolean confusion as "not null", "no export":</p>
<div class="geshifilter">
<pre class="php geshifilter-php" style="font-family:monospace;"><span class="co4">/**
 * Implementation of hook_schema
 */</span>
<span class="kw2">function</span> contacts_schema<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
  <span class="re0">$schema</span><span class="br0">[</span><span class="st_h">'contacts_friend'</span><span class="br0">]</span> <span class="sy0">=</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
    <span class="st_h">'description'</span> <span class="sy0">=&gt;</span> t<span class="br0">(</span><span class="st_h">'Friends'</span><span class="br0">)</span><span class="sy0">,</span>
 
    <span class="st_h">'export'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
      <span class="co1">// Unique key to identify an object</span>
      <span class="st_h">'key'</span> <span class="sy0">=&gt;</span> <span class="st_h">'nickname'</span><span class="sy0">,</span>
      <span class="co1">// Object type identifier, e.g. "enemy" for your enemy exportables!</span>
      <span class="st_h">'identifier'</span> <span class="sy0">=&gt;</span> <span class="st_h">'friend'</span><span class="sy0">,</span>
      <span class="co1">// Function hook name in Features dump</span>
      <span class="st_h">'default hook'</span> <span class="sy0">=&gt;</span> <span class="st_h">'default_contacts_myobj'</span><span class="sy0">,</span>
      <span class="st_h">'api'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
        <span class="co1">// Which module "owns" these objects?</span>
        <span class="st_h">'owner'</span> <span class="sy0">=&gt;</span> <span class="st_h">'contacts'</span><span class="sy0">,</span>
        <span class="co1">// Base name for Features include file</span>
        <span class="st_h">'api'</span> <span class="sy0">=&gt;</span> <span class="st_h">'default_contacts_friends'</span><span class="sy0">,</span>
        <span class="co1">// Exportables API version numbers: black magic; woowoo</span>
        <span class="st_h">'minimum_version'</span> <span class="sy0">=&gt;</span> <span class="nu0">1</span><span class="sy0">,</span>
        <span class="st_h">'current_version'</span> <span class="sy0">=&gt;</span> <span class="nu0">1</span><span class="sy0">,</span>
      <span class="br0">)</span><span class="sy0">,</span>
    <span class="br0">)</span><span class="sy0">,</span>
 
    <span class="st_h">'fields'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
      <span class="st_h">'nickname'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
        <span class="st_h">'description'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Unique nickname for friend'</span><span class="sy0">,</span>
        <span class="st_h">'type'</span> <span class="sy0">=&gt;</span> <span class="st_h">'varchar'</span><span class="sy0">,</span>
        <span class="st_h">'length'</span> <span class="sy0">=&gt;</span> <span class="nu0">32</span><span class="sy0">,</span>
        <span class="st_h">'not null'</span> <span class="sy0">=&gt;</span> <span class="kw4">TRUE</span><span class="sy0">,</span>
      <span class="br0">)</span><span class="sy0">,</span>
      <span class="st_h">'fullname'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
        <span class="st_h">'description'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Friend fullname'</span><span class="sy0">,</span>
        <span class="st_h">'type'</span> <span class="sy0">=&gt;</span> <span class="st_h">'varchar'</span><span class="sy0">,</span>
        <span class="st_h">'length'</span> <span class="sy0">=&gt;</span> <span class="nu0">128</span><span class="sy0">,</span>
        <span class="st_h">'not null'</span> <span class="sy0">=&gt;</span> <span class="kw4">TRUE</span><span class="sy0">,</span>
      <span class="br0">)</span><span class="sy0">,</span>
      <span class="st_h">'do_i_hate'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span>
        <span class="st_h">'description'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Do I secretly hate this person?'</span><span class="sy0">,</span>
        <span class="st_h">'type'</span> <span class="sy0">=&gt;</span> <span class="st_h">'int'</span><span class="sy0">,</span>
        <span class="st_h">'not null'</span> <span class="sy0">=&gt;</span> <span class="kw4">FALSE</span><span class="sy0">,</span>
        <span class="st_h">'default'</span> <span class="sy0">=&gt;</span> <span class="nu0">0</span><span class="sy0">,</span>
        <span class="st_h">'no export'</span> <span class="sy0">=&gt;</span> <span class="kw4">TRUE</span><span class="sy0">,</span>
      <span class="br0">)</span><span class="sy0">,</span>
 
    <span class="st_h">'primary key'</span> <span class="sy0">=&gt;</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span><span class="st_h">'nickname'</span><span class="br0">)</span><span class="sy0">,</span>
  <span class="br0">)</span><span class="sy0">;</span>
  <span class="kw1">return</span> <span class="re0">$schema</span><span class="sy0">;</span>
<span class="br0">}</span></pre></div>
<p>Result? You can still pickle friends into a Feature---if you like that sort of thing---but the contents of any "no export" columns will not be present in the final Feature bundle.</p>
<p>And that's it. You can build interfaces and applications on top of this, but that's all you need to get your database contents up and running through features. All these code snippets <em>should be runnable</em>; that is, you can save them and run them as live code. If you can't, please let me know and I'll fix.</p>
</div></div></div><div id="comments" class="comment-wrapper">
          <h2 class="title">Comments</h2>
      
  <a id="comment-115"></a>
<div class="comment comment-by-anonymous clearfix">

  <div class="attribution">

    
    <div class="submitted">
      <p class="commenter-name">
        <span class="username">Anonymous (not verified)</span>      </p>
      <p class="comment-time">
        Wed, 22/09/2010 - 17:13      </p>
      <p class="comment-permalink">
        <a href="115.html#comment-115" class="permalink" rel="bookmark">Permalink</a>      </p>
    </div>
  </div>

  <div class="comment-text">
    <div class="comment-arrow"></div>

    
    <div style='display: none;'>    <h3><a href="115.html#comment-115" class="permalink" rel="bookmark">Thanks for the tut, a couple questions</a></h3>
    </div>
    <div class="content">
      <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>The code implements hook_install() twice, i think you meant hook_uninstall() the second time.</p>
<p> </p>
<p>Also, I got my exportables working by inserting the 9 lines of code into the hook_schema() like you said (modified to work on my table), and then I went and created a feature. The feature code looks good, it has the data in the code as objects. BUT when I enable the feature, my module's table doesn't change. It's as if the data's not getting properly imported back when I enable the feature, any ideas?</p>
<p> </p>
<p>Maybe my module needs to do an extra step in order to import the data?</p>
<p> </p>
<p>Cheers!</p>
</div></div></div>          </div> <!-- /.content -->

      </div> <!-- /.comment-text -->
</div>

<div class="indented"><a id="comment-118"></a>
<div class="comment comment-by-node-author clearfix">

  <div class="attribution">

    
    <div class="submitted">
      <p class="commenter-name">
        <span class="username">jp.stacey</span>      </p>
      <p class="comment-time">
        Thu, 13/01/2011 - 13:48      </p>
      <p class="comment-permalink">
        <a href="118.html#comment-118" class="permalink" rel="bookmark">Permalink</a>      </p>
    </div>
  </div>

  <div class="comment-text">
    <div class="comment-arrow"></div>

    
    <div style='display: none;'>    <h3><a href="118.html#comment-118" class="permalink" rel="bookmark">Been having problems with comments</a></h3>
    </div>
    <div class="content">
      <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Sorry about that. I've only just discovered yours.</p>
<p>Thanks for the feedback; I've fixed the hook_(un)install now. You're right that you do need some code to re-import the feature exports: my test environment was corrupt and I thought they were getting re-imported when they weren't. I'll write a basic follow-up post when I can but for now if you look at my <a href="https://github.com/jpstacey/Drupal-ConfWizard">Features Conf Wizard module on github</a> then you might be able to find some tricks on how to do the re-import.</p>
</div></div></div>          </div> <!-- /.content -->

      </div> <!-- /.comment-text -->
</div>
</div>
  </div>
</div>

  </div>
</div>
  </div>
      
    </div></div> <!-- /.section, /#content -->

          <div id="sidebar-second" class="column sidebar"><div class="section">
          <div class="region region-sidebar-second">
    <div id="block-block-7" class="block block-block">

    <h2>I&#039;m a Drupal Association member!</h2>
  
  <div class="content">
    <div style="margin: -15px 0"><a href="https://drupal.org/user/130486"><img src="https://association.drupal.org/files/Drupal_Association_ind_member_217_0.png" alt="My individual membership of the Drupal Association" title="You can view my DA membership on drupal.org" width="168" height="168" /></a></div>
  </div>
</div>
<div id="block-block-10" class="block block-block">

    <h2>Drupal 8 API tutorials</h2>
  
  <div class="content">
    <p>Want to learn about the Drupal 8 APIs, with worked examples? <a href="http://www.jpstacey.info/d8api">Follow my series of tutorials</a>, covering routing, caching, entities, config and much more!</p>
  </div>
</div>
<div id="block-stateblock-stateblock" class="block block-stateblock">

    <h2>Want to hire me?</h2>
  
  <div class="content">
    <a href="../contact.html"><section class="state-no">
  <header>I'm currently</header>
  <section class="state-description">fully booked</section>
  <footer>for freelance work. But you can click here to contact me!</footer>
</section></a>  </div>
</div>
<div id="block-ds-extras-blogpost-secondary-nav" class="block block-ds-extras">

    
  <div class="content">
    <div class="field field-name-taxonomy-vocabulary-6 field-type-taxonomy-term-reference field-label-above clearfix"><h3 class="field-label">Blog category: </h3><ul class="links"><li class="taxonomy-term-reference-0"><a href="../category/wordpress-category/import/export.html">import/export</a>, <a href="../category/wordpress-category/quickies.html">quickies</a></li></ul></div><div class="field field-name-taxonomy-vocabulary-7 field-type-taxonomy-term-reference field-label-above clearfix"><h3 class="field-label">Tags: </h3><ul class="links"><li class="taxonomy-term-reference-0"><a href="../category/wordpress-tag/drupal.html">drupal</a>, <a href="../category/tags/ctools.html">ctools</a>, <a href="../category/tags/features.html">features</a></li></ul></div>  </div>
</div>
<div id="block-views-recent-blog-block-1" class="block block-views">

    <h2>Recent blogposts</h2>
  
  <div class="content">
    <div class="view view-recent-blog view-id-recent_blog view-display-id-block_1 view-dom-id-00f5189765bbe09b81503022f160cda5">
        
  
  
      <div class="view-content">
        <ul>
    <li class="first odd">
      
      <h3>
  
    
      <a href="../blog/2017-07-21/altering-length-drupal-8-text-field-contains-data.html">Altering the length of a Drupal 8 text field that contains data</a>
      </h3>
  

      <div>
  
    
      Friday, July 21, 2017 - 11:31
      </div>
  
    </li>
      <li class="even">
      
      <h3>
  
    
      <a href="../blog/2017-06-02/menagerie-testing-behavioural-unit-system-smoke-regression-oh-my.html">A menagerie of testing: behavioural, unit, system, smoke, regression, oh my!</a>
      </h3>
  

      <div>
  
    
      Friday, June 2, 2017 - 10:11
      </div>
  
    </li>
      <li class="last odd">
      
      <h3>
  
    
      <a href="../blog/2017-05-30/including-javascript-behat-tests-all-inside-headless-virtual-machine.html">Including Javascript in Behat tests, all inside a headless, virtual machine</a>
      </h3>
  

      <div>
  
    
      Tuesday, May 30, 2017 - 16:51
      </div>
  
    </li>
    </ul>
    </div>
  
  
  
      
<div class="more-link">
  <a href="../blog_view.html">
    All blogposts  </a>
</div>
  
  
  
</div>  </div>
</div>
<div id="block-block-5" class="block block-block">

    <h2>About me</h2>
  
  <div class="content">
    <p>I'm J-P Stacey, and I'm a freelance technical developer and software architect, working with <a href="http://drupal.org/">Drupal</a>, Javascript, Symfony, PHP and devops, with experience in project and process management and an emphasis on usability.</p>
<p>I live in the <a href="http://gov.uk">UK</a>; my website is self-hosted on <a href="http://bigv.io">bigv.io</a>; my email is hosted by <a href="http://mail.google.com">Google</a>, and that's also what I use to share files. <small>(<a href="https://data-jurisdiction.org/country/GB">More info</a>|<a href="http://www.jpstacey.info/blog/2013-08-20/what-jurisdiction-am-i-in">What is this?</a>)</small></p>
  </div>
</div>
<div id="block-menu-secondary-menu" class="block block-menu">

    <h2>Find me elsewhere</h2>
  
  <div class="content">
    <ul class="menu clearfix"><li class="first leaf"><a href="http://twitter.com/mphield" title="My commercial account on Twitter">Company @ Twitter</a></li>
<li class="leaf"><a href="http://drupal.org/user/130486" title="Drupal user #130486: woohoo!">Drupal @ d.o</a></li>
<li class="leaf"><a href="http://github.com/jpstacey" title="My code repositories on Github">Code @ Github</a></li>
<li class="leaf"><a href="http://flickr.com/photos/eustatius" title="My photos on Flickr">Photos @ Flickr</a></li>
<li class="last leaf"><a href="http://pinboard.in/u:jpstacey" title="My links on the Pinboard bookmarking site">Links @ Pinboard</a></li>
</ul>  </div>
</div>
  </div>
      </div></div> <!-- /.section, /#sidebar-second -->
    
  </div></div> <!-- /#main, /#main-wrapper -->

  
  <div id="footer-wrapper"><div class="section">

    
    
  </div></div> <!-- /.section, /#footer-wrapper -->

</div></div> <!-- /#page, /#page-wrapper -->
  </body>
</html>
